<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Some very simple reverse challenges from WPICTF 2022."><title>WPICTF 2022 - Reverse - Warmup</title>
<link rel=canonical href=https://dorianb.net/blog/p/wpictf-2022-reverse-warmup/><link rel=stylesheet href=/blog/scss/style.min.948bc58529b976e077ee8406afe524b877fa247c3885982c422b19e7f90131e6.css><meta property='og:title' content="WPICTF 2022 - Reverse - Warmup"><meta property='og:description' content="Some very simple reverse challenges from WPICTF 2022."><meta property='og:url' content='https://dorianb.net/blog/p/wpictf-2022-reverse-warmup/'><meta property='og:site_name' content='Dorian B.'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='reverse'><meta property='article:published_time' content='2022-10-04T18:35:19+02:00'><meta property='article:modified_time' content='2022-10-04T18:35:19+02:00'><meta property='og:image' content='https://dorianb.net/blog/p/wpictf-2022-reverse-warmup/1_cutter.png'><meta name=twitter:title content="WPICTF 2022 - Reverse - Warmup"><meta name=twitter:description content="Some very simple reverse challenges from WPICTF 2022."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://dorianb.net/blog/p/wpictf-2022-reverse-warmup/1_cutter.png'><link rel="shortcut icon" href=/blog/favicon.ico><style>.navigation-bar{margin-top:20px;margin-right:10px}.navigation-bar ul{cursor:default;list-style:none;padding-left:0;justify-content:right;display:flex;overflow-x:visible}.navigation-bar li.icon a{display:block;padding:10px;border:2px solid grey;border-radius:0;margin-right:-2px;display:inline;float:left;justify-content:center;font-weight:700;color:#fff}.navigation-bar li.icon a:hover{background-color:grey}.navigation-bar li.icon a span{margin-right:5px}</style><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css rel=stylesheet type=text/css><div class=navigation-bar><ul><li class=icon><a href=https://dorianb.net><span class="fa fa-home"></span>
Home</a></li><li class=icon><a href=https://dorianb.net/blog><span class="fa fa-book"></span>
Blog</a></li><li class=icon><a href=https://www.degate.org><span style=display:flex;justify-content:center;align-items:center><img style=width:20px;height:auto src=https://raw.githubusercontent.com/DegateCommunity/Degate/refs/heads/develop/res/degate_logo.png alt=Degate>
&nbsp; Degate</span></a></li><li class=icon><a href=https://dorianb.net/toolbox><span class="fa fa-archive"></span>
Toolbox</a></li></ul></div></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.setItem(e,"dark")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky compact"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/blog/><img src="https://avatars.githubusercontent.com/u/20194872?s=400&amp;u=985e4b2550b35686b0be0900b145e2740b235265&amp;v=4" width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üêô</span></figure><div class=site-meta><h1 class=site-name><a href=/blog>Dorian B.</a></h1><h2 class=site-description>Understand, don't memorize.</h2></div></header><ol class=menu-social><li><a href=https://www.linkedin.com/in/dorian-bachelot/ target=_blank title=Linkedin rel=me><svg class="icon icon-tabler icon-tabler-brand-linkedin" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=https://github.com/DorianBDev target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://gitlab.com/DorianBDev target=_blank title=Gitlab rel=me><svg class="icon icon-tabler icon-tabler-brand-gitlab" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 14l-9 7-9-7L6 3l3 7h6l3-7z"/></svg></a></li><li><a href=https://x.com/dorianbchlt target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li><a href=https://www.root-me.org/dorianbdev target=_blank title=RootMe rel=me><svg class="icon icon-tabler icon-tabler-skull" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 4c4.418.0 8 3.358 8 7.5.0 1.901-.755 3.637-2 4.96V19a1 1 0 01-1 1H7a1 1 0 01-1-1v-2.54c-1.245-1.322-2-3.058-2-4.96C4 7.358 7.582 4 12 4z"/><path d="M10 17v3"/><path d="M14 17v3"/><path d="M9 11m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M15 11m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></a></li><li><a href=https://app.hackthebox.com/profile/880964 target=_blank title="Hack The Box" rel=me><svg class="icon icon-tabler icon-tabler-archive" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 4m0 2a2 2 0 012-2h14a2 2 0 012 2v0a2 2 0 01-2 2H5A2 2 0 013 6z"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><path d="M10 12h4"/></svg></a></li><li><a href=https://dorianb.net/blog/index.xml target=_blank title="Rss Feed" rel=me><svg class="icon icon-tabler icon-tabler-rss" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/blog/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/blog/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/blog/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/blog/p/wpictf-2022-reverse-warmup/><img src=/blog/p/wpictf-2022-reverse-warmup/1_cutter_hu12599459358540815710.png srcset="/blog/p/wpictf-2022-reverse-warmup/1_cutter_hu12599459358540815710.png 800w, /blog/p/wpictf-2022-reverse-warmup/1_cutter_hu1966346810156997953.png 1600w" width=800 height=341 loading=lazy alt="Featured image of post WPICTF 2022 - Reverse - Warmup"></a></div><div class=article-details><header class=article-category><a href=/blog/categories/write-up/ style=background-color:#ff3b3b;color:#fff>Write-up</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/blog/p/wpictf-2022-reverse-warmup/>WPICTF 2022 - Reverse - Warmup</a></h2><h3 class=article-subtitle>Some very simple reverse challenges from WPICTF 2022.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Oct 04, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>7 minute read</time></div></footer></div></header><section class=article-content><p class=note>This post was written in 2022, but I had never posted it by accident. Published in October 2024.</p><h1 id=introduction><a href=#introduction class=header-anchor></a>Introduction</h1><p>To do a small warming up before the <a class=link href=https://challenge.risksummit.fr/ target=_blank rel=noopener>Purple Pill Challenge CTF</a>, we participated in the WPICTF 2022 CTF (online, hosted by <a class=link href=https://wpictf.xyz/ target=_blank rel=noopener>Worcester Polytechnic Institute Cyber Security Club</a>). Since the solved reverse challenges were a bit simple, you&rsquo;ll find in this post a collection of some of them rather than a single one (opposed to the tradition).</p><h2 id=taylors-serious-data><a href=#taylors-serious-data class=header-anchor></a>Taylor&rsquo;s Serious Data</h2><p>This was a (very) simple one. We were given an x64 ELF binary with a text file &ldquo;songLyrics.txt&rdquo; that seems encrypted. After opening the binary in <a class=link href=https://cutter.re/ target=_blank rel=noopener>Cutter</a>, we can find the encryption routine in the <code>main</code> function:</p><p><img src=/blog/p/wpictf-2022-reverse-warmup/1_cutter.png width=1705 height=726 srcset="/blog/p/wpictf-2022-reverse-warmup/1_cutter_hu3176412777005471951.png 480w, /blog/p/wpictf-2022-reverse-warmup/1_cutter_hu3263805415040614959.png 1024w" loading=lazy alt="Encryption routine from Cutter" class=gallery-image data-flex-grow=234 data-flex-basis=563px></p><p>As we can see in the decompiler window, the binary takes two arguments:</p><ul><li>An initial file path,</li><li>A file path to store the decrypted version of the first file.</li></ul><p>Then, the function load a file from disk (for sure the <code>songLyrics.txt</code> file), and read it. After that, it retrieves the content size of the file, and start the decryption loop. When dealing with this kind of loop, I prefer to deal with the assembly directly rather the decompiler. After a simple analysis, I found that the decryption loop was:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=kr>for</span> <span class=n>character</span> <span class=n>c</span> <span class=kr>in</span> <span class=n>file</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>output</span> <span class=o>=</span> <span class=n>c</span> <span class=o>*</span> <span class=m>7</span> <span class=o>+</span> <span class=m>34</span>
</span></span></code></pre></td></tr></table></div></div><p>As we can see, the Ghidra decompiler was right (this time üòÅ), and we can write a simple python script that will decrypt the given file for us:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>file</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./songLyrics.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>content</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>     
</span></span><span class=line><span class=cl><span class=n>content</span> <span class=o>=</span> <span class=n>content</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>content</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=n>c</span> <span class=o>-</span> <span class=mh>0x22</span><span class=p>)</span> <span class=o>/</span> <span class=mh>0xd</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>a</span><span class=p>),</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>We then obtain the decrypted version of our file (and the filename was right, it&rsquo;s a song lyric):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>But I got smarter, I got harder in the nick of time
</span></span><span class=line><span class=cl>[...]
</span></span><span class=line><span class=cl>Honey, WPI{TaYl0rs_v3rS1oN} I rose up from the dead, I do it all the time
</span></span><span class=line><span class=cl>I got a list of names, and yours is in red, underlined
</span></span><span class=line><span class=cl>[...]
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><p>And we get the flag <code>WPI{TaYl0rs_v3rS1oN}</code>. This was a very simple warmup, no tricky things here.</p><h2 id=xf1ltr80r><a href=#xf1ltr80r class=header-anchor></a>xf1ltr80r</h2><p>Let&rsquo;s investigate a second challenge. We start with a x64 ELF binary, and since I liked using <a class=link href=https://cutter.re/ target=_blank rel=noopener>Cutter</a> on the previous challenge, I&rsquo;ll continue with it. After opening the binary, we easily find the function containing &ldquo;data to exfiltrate&rdquo;:</p><p><img src=/blog/p/wpictf-2022-reverse-warmup/2_cutter.png width=1642 height=735 srcset="/blog/p/wpictf-2022-reverse-warmup/2_cutter_hu10630198225006241156.png 480w, /blog/p/wpictf-2022-reverse-warmup/2_cutter_hu17712458855507100362.png 1024w" loading=lazy alt="Disassembly of a function with data to exfiltrate" class=gallery-image data-flex-grow=223 data-flex-basis=536px></p><p>The padding (<code>==</code>) at the end of the many blobs of data seem to indicate a base64 encoded string. Let&rsquo;s retrieve the full encoded string:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>V1BJezN4dHIzbTNseV9uI3JkeV8xMzM3NXAzNGt9Cg==
</span></span></code></pre></td></tr></table></div></div><p>We can now use <a class=link href=https://gchq.github.io/CyberChef/ target=_blank rel=noopener>Cyberchef</a> to perform the operation:</p><p><img src=/blog/p/wpictf-2022-reverse-warmup/2_cyberchef.png width=1081 height=579 srcset="/blog/p/wpictf-2022-reverse-warmup/2_cyberchef_hu14890578941520613932.png 480w, /blog/p/wpictf-2022-reverse-warmup/2_cyberchef_hu14397135831186950462.png 1024w" loading=lazy alt="Base64 conversion using CyberChef" class=gallery-image data-flex-grow=186 data-flex-basis=448px></p><p>And another flag: <code>WPI{3xtr3m3ly_n#rdy_13375p34k}</code>. Very trivial.</p><h2 id=needtocough><a href=#needtocough class=header-anchor></a>NeedToCough</h2><p>This is the last &ldquo;easy&rdquo; challenge I did and it was, in my opinion, the best one (still trivial, but the journey was nice and somehow realistic). We start the challenge with a <code>pcap</code> file that contains multiple HTTP requests and an encrypted file that was a <code>jpg</code> image. After analyzing some frames, I found that these requests contained a file. Therefore, I exported it using Wireshark:</p><p><img src=/blog/p/wpictf-2022-reverse-warmup/3_wireshark.png width=1264 height=537 srcset="/blog/p/wpictf-2022-reverse-warmup/3_wireshark_hu8864296869193243619.png 480w, /blog/p/wpictf-2022-reverse-warmup/3_wireshark_hu10602324327538375380.png 1024w" loading=lazy alt="Wireshark view of the pcap" class=gallery-image data-flex-grow=235 data-flex-basis=564px></p><p>I obtained (again) a nice x64 ELF binary file. Since it worked well for the previous challenges, I stayed with <a class=link href=https://cutter.re/ target=_blank rel=noopener>Cutter</a> here, and analyzed the code. After a high level review on the disassembly, I found that the majority of the code was garbage about a notice drop (ransomware-like), so I focused on the encryption loop. I found four interesting functions:</p><ul><li>One that converts an input to hexadecimal code,</li><li>A second that generates a hexadecimal table (for the permutation),</li><li>An encryption function that uses a permutation table (over hexadecimal),</li><li>And a last one that generates the permutation table.</li></ul><p>The part that generates the permutation table is at the beginning of a function that also deals with the notice part (useless here):</p><p><img src=/blog/p/wpictf-2022-reverse-warmup/3_permutation_table.png width=1674 height=723 srcset="/blog/p/wpictf-2022-reverse-warmup/3_permutation_table_hu12316788749329434372.png 480w, /blog/p/wpictf-2022-reverse-warmup/3_permutation_table_hu7607281273934456954.png 1024w" loading=lazy alt="Disassembly of a function that generate the permutation table" class=gallery-image data-flex-grow=231 data-flex-basis=555px></p><p>As I said before, I prefer to look at the assembly rather than the decompiler code (especially when you see how little code is present). I extracted this pseudo-code used to generate the permutation table:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=kr>for</span> <span class=n>i</span> <span class=kr>in</span> <span class=n>[0</span><span class=p>,</span><span class=m>16</span><span class=n>]</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>output[i]</span> <span class=o>=</span> <span class=n>key1[i</span> % <span class=mh>0x17</span><span class=n>]</span> <span class=n>^</span> <span class=n>key2[i]</span>
</span></span></code></pre></td></tr></table></div></div><p>I then successfully extracted the two keys <code>key1</code> and <code>key2</code> from the binary:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Extracted key1</span>
</span></span><span class=line><span class=cl><span class=n>key1_first</span> <span class=o>=</span> <span class=s1>&#39;6874202e2e2e6159&#39;</span>
</span></span><span class=line><span class=cl><span class=n>key1_second</span> <span class=o>=</span> <span class=s1>&#39;6157207369207369&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Since we were in little endian, we needed to convert it before concatenation:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Convert it since we are in little endian</span>
</span></span><span class=line><span class=cl><span class=n>key1_first</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>key1_first</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key1_first</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>key1_second</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>key1_second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key1_second</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>key1</span> <span class=o>=</span> <span class=n>key1_first</span> <span class=o>+</span> <span class=n>key1_second</span>
</span></span></code></pre></td></tr></table></div></div><p>We do the same with the <code>key2</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Extracted key2</span>
</span></span><span class=line><span class=cl><span class=n>key2_first</span> <span class=o>=</span> <span class=s1>&#39;5d46661f181e226e&#39;</span>
</span></span><span class=line><span class=cl><span class=n>key2_second</span> <span class=o>=</span> <span class=s1>&#39;2316644050143651&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Convert it since we are in little endian</span>
</span></span><span class=line><span class=cl><span class=n>key2_first</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>key2_first</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key2_first</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>key2_second</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>key2_second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key2_second</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>key2</span> <span class=o>=</span> <span class=n>key2_first</span> <span class=o>+</span> <span class=n>key2_second</span>
</span></span></code></pre></td></tr></table></div></div><p>We can now recreate the algorithm that generates the permutation table:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Generate the permutation table from the two keys</span>
</span></span><span class=line><span class=cl><span class=n>permutation_table</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>permutation_table</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>key1</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mh>0x17</span><span class=p>]</span> <span class=o>^</span> <span class=n>key2</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p>Then, we can continue with another easy part, by analyzing the hexadecimal table generation code:</p><p><img src=/blog/p/wpictf-2022-reverse-warmup/3_hexa_table.png width=1674 height=723 srcset="/blog/p/wpictf-2022-reverse-warmup/3_hexa_table_hu18277090219136337833.png 480w, /blog/p/wpictf-2022-reverse-warmup/3_hexa_table_hu10540558793563325895.png 1024w" loading=lazy alt="Function that generate a string" class=gallery-image data-flex-grow=231 data-flex-basis=555px></p><p>We can translate this assembly function to python:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>table</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>9</span> <span class=o>+</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># First loop, for the first 9 characters</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>9</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>9</span> <span class=o>-</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;9&#39;</span><span class=p>)</span> <span class=o>-</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Second loop, for the 7 remaining characters</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>9</span> <span class=o>+</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;@&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>As we can see, it&rsquo;s a complicated code for a simple task, in the end it just generate this string:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0123456789ABCDEF
</span></span></code></pre></td></tr></table></div></div><p>We can now analyze the main encryption loop:</p><p><img src=/blog/p/wpictf-2022-reverse-warmup/3_permutation_loop.png width=1674 height=723 srcset="/blog/p/wpictf-2022-reverse-warmup/3_permutation_loop_hu11268722187079686179.png 480w, /blog/p/wpictf-2022-reverse-warmup/3_permutation_loop_hu10350114352789236765.png 1024w" loading=lazy alt="Disassembly of the main encryption loop" class=gallery-image data-flex-grow=231 data-flex-basis=555px></p><p>As we can see in <a class=link href=https://cutter.re/ target=_blank rel=noopener>Cutter</a>, the permutation loop is very simple, and we can reconstruct it in python:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0xbeca</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>initial_image</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>encrypted_image</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>permutation_table</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>We then revert the operation and get this python code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0xbeca</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>encrypted_image</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>permutation_table</span><span class=p>[</span><span class=n>j</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>initial_image</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Since our image already contains the ASCII representation of the file content in hexadecimal, we can retrieve the initial image with this python code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Extracted key1</span>
</span></span><span class=line><span class=cl><span class=n>key1_first</span> <span class=o>=</span> <span class=s1>&#39;6874202e2e2e6159&#39;</span>
</span></span><span class=line><span class=cl><span class=n>key1_second</span> <span class=o>=</span> <span class=s1>&#39;6157207369207369&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Extracted key2</span>
</span></span><span class=line><span class=cl><span class=n>key2_first</span> <span class=o>=</span> <span class=s1>&#39;5d46661f181e226e&#39;</span>
</span></span><span class=line><span class=cl><span class=n>key2_second</span> <span class=o>=</span> <span class=s1>&#39;2316644050143651&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Convert it since we are in little endian</span>
</span></span><span class=line><span class=cl><span class=n>key1_first</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>key1_first</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key1_first</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>key1_second</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>key1_second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key1_second</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>key1</span> <span class=o>=</span> <span class=n>key1_first</span> <span class=o>+</span> <span class=n>key1_second</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Convert it since we are in little endian</span>
</span></span><span class=line><span class=cl><span class=n>key2_first</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>key2_first</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key2_first</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>key2_second</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>key2_second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>key2_second</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>key2</span> <span class=o>=</span> <span class=n>key2_first</span> <span class=o>+</span> <span class=n>key2_second</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Generate the permutation table from the two keys</span>
</span></span><span class=line><span class=cl><span class=n>permutation_table</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>permutation_table</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>key1</span><span class=p>[</span><span class=n>i</span> <span class=o>%</span> <span class=mh>0x17</span><span class=p>]</span> <span class=o>^</span> <span class=n>key2</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>table</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>9</span> <span class=o>+</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># First loop, for the first 9 characters</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>9</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>9</span> <span class=o>-</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;9&#39;</span><span class=p>)</span> <span class=o>-</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Second loop, for the 7 remaining characters</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=p>[</span><span class=mi>9</span> <span class=o>+</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=s1>&#39;@&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Comp = out = res (what we need to retrieve)</span>
</span></span><span class=line><span class=cl><span class=n>initial_image</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=mh>0xbeca</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Out = pvVar2 = encrypted (what we know)</span>
</span></span><span class=line><span class=cl><span class=n>file</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./flag.cough&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>encrypted_image</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Logic</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0xbeca</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mh>0x10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>encrypted_image</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>permutation_table</span><span class=p>[</span><span class=n>j</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>initial_image</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>table</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dump flag</span>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./flag.jpg&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>A tip I used to debug this script was checking that we get the magic number of JPEG files for the first bytes. This can also be used to brute force the permutation table (if you don&rsquo;t like reverse engineering üòâ).</p><p>After running the script on the provided file (containing the encrypted image to retrieve), I obtained the initial image:</p><p><img src=/blog/p/wpictf-2022-reverse-warmup/3_res.png width=882 height=644 srcset="/blog/p/wpictf-2022-reverse-warmup/3_res_hu10892184501899858558.png 480w, /blog/p/wpictf-2022-reverse-warmup/3_res_hu6784426109922216340.png 1024w" loading=lazy alt="Final image containing the flag" class=gallery-image data-flex-grow=136 data-flex-basis=328px></p><p>And the flag was <code>WPI{cybercriminals != pentesters}</code>!</p><p>Thanks for this well-made challenge, that were not difficult but well constructed (from Wireshark to reverse).</p><h1 id=conclusion><a href=#conclusion class=header-anchor></a>Conclusion</h1><p>Those reverse challenges were fun to complete even if a bit too simple. They were a good training for our big event (the <a class=link href=https://challenge.risksummit.fr/ target=_blank rel=noopener>Purple Pill Challenge CTF</a>) that were 5 days after this one. Maybe it can help someone getting into reverse ü§∑‚Äç‚ôÇÔ∏è</p></section><footer class=article-footer><section class=article-tags><a href=/blog/tags/reverse/>Reverse</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/blog/p/wpictf-2022-pwn-calicovision/><div class=article-image><img src=/blog/p/wpictf-2022-pwn-calicovision/gdb_overflow.8211f2605ad098f947ed3692cbb59e40_hu3789439795829481803.png width=250 height=150 loading=lazy alt="Featured image of post WPICTF 2022 - PWN - Calicovision" data-hash="md5-ghHyYFrQmPlH7TaSy7WeQA=="></div><div class=article-details><h2 class=article-title>WPICTF 2022 - PWN - Calicovision</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=DorianBDev/blog data-repo-id=R_kgDOHqETOg data-category=Comments data-category-id=DIC_kwDOHqETOs4Ci_rr data-mapping=pathname data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=noborder_light data-lang=en crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"noborder_light":"noborder_dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2022 -
2024 Dorian B.</section><section class=powerby></section><a href=https://dorianb.net/blog/index.xml target=_blank title="RSS feed" rel=me><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg>
RSS-feed</a></footer><style>.star{display:block;background-color:#fff;position:absolute;border-radius:100%;animation-timing-function:linear;animation-iteration-count:infinite}@keyframes move_right{from{transform:rotate(0)translateX(8px)rotate(0)}to{transform:rotate(360deg)translateX(8px)rotate(-360deg)}}@keyframes move_left{from{transform:rotate(0)translateX(8px)rotate(0)}to{transform:rotate(-360deg)translateX(8px)rotate(360deg)}}</style><script>var randomNumber=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},numberOfStars=randomNumber(350,650),createStars=function(){for(var t,i,a,r,c,l="move_right;",n=document.body,e=document.documentElement,d=Math.max(n.scrollHeight,n.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight),s="",o=0;o<numberOfStars;o++)i=l==="move_right;"?"move_left;":"move_right;",a=randomNumber(0,d),r=randomNumber(0,window.innerWidth),t=randomNumber(0,4),c=randomNumber(6,16),s+="<div class='star' style='top: "+a+"px; left: "+r+"px; width: "+t+"px; height: "+t+"px; animation-name:"+i+"; animation-duration: "+c+"s;z-index: -1;'></div>";document.body.innerHTML+="<div id='stars'>"+s+"</div>"};setTimeout(function(){createStars()},10)</script><script>if(document.getElementsByClassName("main-article").length!=0){var header,oldScheme,sidebars,hideSidebar,toc,hideTOC,article_header=document.getElementsByClassName("article-time");article_header.length==1&&(header=article_header[0],header.innerHTML+=`
            <div> 
                <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-feather"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20l10 -10m0 -5v5h5m-9 -1v5h5m-9 -1v5h5m-5 -5l4 -4l4 -4" /><path d="M19 10c.638 -.636 1 -1.515 1 -2.486a3.515 3.515 0 0 0 -3.517 -3.514c-.97 0 -1.847 .367 -2.483 1m-3 13l4 -4l4 -4" /></svg>

                <a href="https://dorianb.net">
                    <time class="article-time--published" style="margin-left: -5px;">Dorian BACHELOT</time>
                </a>
            </div>`,oldScheme=document.documentElement.getAttribute("data-scheme"),window.onbeforeprint=function(){oldScheme=document.documentElement.getAttribute("data-scheme"),document.documentElement.setAttribute("data-scheme","light")},window.onafterprint=function(){document.documentElement.setAttribute("data-scheme",oldScheme)},header.innerHTML+=`
            <div id="print"> 
                <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-printer"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" /><path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" /><path d="M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z" /></svg>

                <a href="javascript:void('Open print window')" onclick="window.print()">
                    <time class="article-time--published" style="margin-left: -5px;">Print</time>
                </a>
            </div>`,sidebars=document.getElementsByClassName("left-sidebar"),hideSidebar=function(){if(sidebars.length>0){var e=sidebars[0];e.style.display!="none"?e.style.display="none":e.style.display="flex"}},sidebars.length>0&&(header.innerHTML+=`
                <div id="sidebars-control"> 
                    <a href="javascript:void('Hide sidebar')" onclick="hideSidebar()">
                        <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-layout-sidebar-left-collapse"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 3a3 3 0 0 1 2.995 2.824l.005 .176v12a3 3 0 0 1 -2.824 2.995l-.176 .005h-12a3 3 0 0 1 -2.995 -2.824l-.005 -.176v-12a3 3 0 0 1 2.824 -2.995l.176 -.005h12zm0 2h-9v14h9a1 1 0 0 0 .993 -.883l.007 -.117v-12a1 1 0 0 0 -.883 -.993l-.117 -.007zm-2.293 4.293a1 1 0 0 1 .083 1.32l-.083 .094l-1.292 1.293l1.292 1.293a1 1 0 0 1 .083 1.32l-.083 .094a1 1 0 0 1 -1.32 .083l-.094 -.083l-2 -2a1 1 0 0 1 -.083 -1.32l.083 -.094l2 -2a1 1 0 0 1 1.414 0z" /></svg>
                    </a>
                </div>`),toc=document.getElementsByClassName("right-sidebar"),hideTOC=function(){if(toc.length>0){var e=toc[0];e.style.display!="none"?e.style.display="none":e.style.display="flex"}},toc.length>0&&(header.innerHTML+=`
                <div id="sidebars-control" style="margin-left: -15px;"> 
                    <a href="javascript:void('Hide TOC')" onclick="hideTOC()">
                        <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-layout-sidebar-right-collapse"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 3a3 3 0 0 1 2.995 2.824l.005 .176v12a3 3 0 0 1 -2.824 2.995l-.176 .005h-12a3 3 0 0 1 -2.995 -2.824l-.005 -.176v-12a3 3 0 0 1 2.824 -2.995l.176 -.005h12zm-3 2h-9a1 1 0 0 0 -.993 .883l-.007 .117v12a1 1 0 0 0 .883 .993l.117 .007h9v-14zm-5.387 4.21l.094 .083l2 2a1 1 0 0 1 .083 1.32l-.083 .094l-2 2a1 1 0 0 1 -1.497 -1.32l.083 -.094l1.292 -1.293l-1.292 -1.293a1 1 0 0 1 -.083 -1.32l.083 -.094a1 1 0 0 1 1.32 -.083z" /></svg>
                    </a>
                </div>`))}</script><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/blog/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>